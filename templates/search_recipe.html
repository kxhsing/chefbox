{% extends 'base.html' %}

{% block title %}Search Recipe{% endblock %}

{% block content %}

    <h2>Search for a Recipe</h2>
    {% if user.ingredients %}
      <p>Include Ingredients from Inventory:</p>
      <form action="/request_recipe" method="POST">
        <ul id="ingred-list">
          {% for ingredient in user.ingredients %}
              <li><input type="checkbox" name="search_ingredients" value="{{ ingredient.ingred_name }}" checked>{{ ingredient.ingred_name.title() }}</li>
          {% endfor %}
        </ul>
        {% endif %}<br>

          Preferred Cuisine(s)<br>
          (optional):<br>
            <ul>
            {% for cuisine in cuisines %}
                <li><input type="checkbox" name="cuisines" value="{{ cuisine }}">{{ cuisine.title() }}</li>
            {% endfor %}
            </ul><br>


          Dietary Restrictions: 
          <select name="diet">
            <option value="">None</option><br>
            {% for diet in diets %}
            <option value="{{ diet }}">{{ diet.title() }}</option><br>
            {% endfor %}
          </select><br>

          <p></p>

          Allergies or Intolerances: 
            <ul>
            {% for intolerance in intolerances %}
                <li><input type="checkbox" name="intolerances" value="{{ intolerance }}">{{ intolerance.title() }}</li>
            {% endfor %}
            </ul><br>
        <input type="submit" value="Search">
        </form>



    <p>Forget something? Add an ingredient:</p>
      <form action="/add_ingred" method="POST" id="add-ingred">
        <input type="text" name="ingredient" id="ingredient">
        <input type="submit" value="Add">
      </form>

    <script>

      function ingredAddResult(result) {
        console.log(result);
        var ingredList = $("#ingred-list");
        var ingredientName = result.ingredient;
        if (ingredientName) {
        var ingredID = result.ingred_id;
        console.log(ingredID);
        ingredList[0].innerHTML = ingredList.html() + '<li><input type="checkbox" name="search_ingredients" value="'+ingredientName+'" checked>'+ingredientName+'</li>';
        };
      }

      function addIngred(evt) {
        evt.preventDefault();

        var formInputs = {
          "ingredient": $("#ingredient").val()
        };

        $.post("/add_ingred", formInputs, ingredAddResult);
      }

      $("#add-ingred").on("submit", addIngred);


   </script>






{% endblock %}




